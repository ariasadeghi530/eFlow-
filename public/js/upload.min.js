let firebaseConfig = { apiKey: "AIzaSyBzgX-ul7zTpGeWsXddZ6IItDw9cRkbnCU", authDomain: "eflow-ca056.firebaseapp.com", databaseURL: "https://eflow-ca056.firebaseio.com", projectId: "eflow-ca056", storageBucket: "eflow-ca056.appspot.com", messagingSenderId: "462392261016", appId: "1:462392261016:web:8a3313fd188f398632d3ed", measurementId: "G-HQ8KKYT6QX" }; firebase.initializeApp(firebaseConfig); let uid, uploadId, bar = $("#js-progressbar"), fileButton = $("#filebutton"); axios.get(`/api/users/getinfo`).then(({ data: a }) => { uid = a.id }).catch(a => console.error(a)), fileButton.change(a => { let b = a.target.files[0], c = b.name, d = firebase.storage().ref("images/" + b.name), e = d.put(b); e.on(firebase.storage.TaskEvent.STATE_CHANGED, progress = a => { let b = 100 * (a.bytesTransferred / a.totalBytes); bar.value = b }, error = () => { }, complete = () => { e.snapshot.ref.getDownloadURL().then(function (a) { let b = { fileid: c, path: a, contents: "", userId: uid }; console.log(b), axios.post("/api/upload", { uploadObj: b }).then(a => { uploadId = a.id, $("#uploadDisplay").html("Image added."), $("#form-upload-id").val(uploadId), console.log($("#form-upload-id").val()) }).catch(a => console.error(a)), console.log("File available at", a) }) }) });



